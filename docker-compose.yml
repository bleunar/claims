name: claims-stack

services:
  claims-backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: claims-backend
    restart: unless-stopped
    env_file: .env
    volumes:
      - user_uploads:/app/uploads
      - logs:/app/logs
    secrets:
      - mysql_password
      - secret_key
      - jwt_secret_key
      - mail_password
      - admin_init_password
    networks:
      - claims-network

  claims-frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: claims-frontend
    restart: unless-stopped
    env_file: .env
    depends_on:
      - claims-backend
    networks:
      - claims-network

volumes:
  user_uploads:
  logs:

secrets:
  mysql_password:
    file: ./secrets/mysql_password.txt
  secret_key:
    file: ./secrets/secret_key.txt
  jwt_secret_key:
    file: ./secrets/jwt_secret_key.txt
  mail_password:
    file: ./secrets/mail_password.txt
  admin_init_password:
    file: ./secrets/admin_init_password.txt

networks:
  claims-network:
    name: claims-network
    driver: bridge
